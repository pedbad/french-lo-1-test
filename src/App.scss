// App.scss

@use "./styles/colours.module" as *;
@use "./styles/media-queries" as *;
@use "./styles/variables.module" as *;
@use "./styles/mixins.module" as *;
@use "sass:color";

.lo-menu {
	display: flex;
}
// .main-header,
// .top-menu {
// 	position: fixed;
// }

// h1,
// h2,
// h3 {
// 	clear: both;
// }

// h1,
// h2,
// h3,
// h4,
// h5 {
// 	font-weight: normal;
// }

html {
	scroll-behavior: smooth;
	&.debug {
		.blanks-container .target-board .word.blank span {
			opacity: 0.2;
		}
	}

	&.can-speak {
			#content {
	.modal-link,
	.modal-link:visited {
		color: var(--ped-warn);
		text-decoration: underline;
		text-underline-offset: 3px;
		cursor: pointer;
					// following doesn't help eliminate contextual search :-(
					-webkit-user-select: none; /* Chrome/Safari */
					-moz-user-select: none; /* Firefox */
					-ms-user-select: none; /* IE10+ */
					user-select: none; /* Standard */
				}
				.speak {
					color: var(--primary);
					text-decoration: underline;
					text-underline-offset: 3px;
					cursor: pointer;
				}
			.modal-link {
				position: relative;
				padding-right: 22px;

				&::before,
				&::after {
					content: "";
					position: absolute;
					right: 0;
					top: 50%;
					pointer-events: none;
				}

				&::before {
					width: 20px;
					height: 20px;
					transform: translateY(-50%);
					background-color: currentColor;

					-webkit-mask-image: url("/images/icons/message-square-warning.svg");
					-webkit-mask-repeat: no-repeat;
					-webkit-mask-position: center;
					-webkit-mask-size: contain;

					mask-image: url("/images/icons/message-square-warning.svg");
					mask-repeat: no-repeat;
					mask-position: center;
					mask-size: contain;
				}
				&::after {
					display: none;
				}
			}
		}
		#SpeechSynthesisError {
			display: none;
			// opacity: 0;
			// transition: opacity 0;
			animation-name: none;
		}
	}
}

.flash {
	animation-name: flash-animation;
	animation-duration: 1000ms;
	animation-timing-function: ease;
	animation-iteration-count: 3;
}

.flash-target {
	animation-name: anchor-flash;
	animation-duration: 1000ms;
	animation-iteration-count: 3;
}

.modal-link-target.flash-target {
	background-color: color-mix(in oklab, var(--ped-warn) 40%, transparent);
	box-shadow: 0 0 0 5px color-mix(in oklab, var(--ped-warn) 20%, transparent);
	border-radius: 0.4rem;
	display: inline-block;
	padding: 0.1rem 0.4rem;
}

.modal-highlight-flash {
	animation: modal-highlight-flash 1000ms ease 3;
	border-radius: 0.4rem;
	display: inline-block;
	padding: 0.1rem 0.35rem;
}

.btn-ped-warn {
	background-color: var(--ped-warn);
	border-color: var(--ped-warn);
	color: var(--primary-foreground);
}

.btn-ped-warn:hover {
	background-color: color-mix(in oklab, var(--ped-warn) 85%, var(--foreground));
}

.btn-chart-2 {
	background-color: var(--chart-2);
	border-color: var(--chart-2);
	color: var(--primary-foreground);
}

.btn-chart-2:hover {
	background-color: color-mix(in oklab, var(--chart-2) 85%, var(--foreground));
}

.btn-hero-title {
	background-color: var(--chart-3);
	border-color: var(--chart-3);
	color: var(--primary-foreground);
}

.btn-hero-title:hover {
	background-color: color-mix(in oklab, var(--chart-3) 85%, var(--foreground));
}

@keyframes flash-animation {
	0% {
		background-color: color-mix(in oklab, var(--ring) 0%, transparent);
	}
	50% {
		background-color: var(--ring);
	}
	100% {
		background-color: color-mix(in oklab, var(--ring) 0%, transparent);
	}
}

@keyframes button-flash-animation {
	0% {
		background-color: color-mix(in oklab, var(--ring) 0%, transparent);
		color: var(--foreground);
	}
	50% {
		background-color: var(--ring);
	}
	100% {
		background-color: color-mix(in oklab, var(--ring) 0%, transparent);
		color: initial;
	}
}

@keyframes anchor-flash {
	0% {
		background-color: color-mix(in oklab, var(--ped-warn) 20%, transparent);
		box-shadow: 0 0 0 0 color-mix(in oklab, var(--ped-warn) 20%, transparent);
	}
	50% {
		background-color: color-mix(in oklab, var(--ped-warn) 50%, transparent);
		box-shadow: 0 0 0 6px color-mix(in oklab, var(--ped-warn) 25%, transparent);
	}
	100% {
		background-color: color-mix(in oklab, var(--ped-warn) 20%, transparent);
		box-shadow: 0 0 0 0 color-mix(in oklab, var(--ped-warn) 20%, transparent);
	}
}

@keyframes modal-highlight-flash {
	0% {
		background-color: color-mix(in oklab, var(--ped-warn) 8%, transparent);
		box-shadow: 0 0 0 0 color-mix(in oklab, var(--ped-warn) 8%, transparent);
	}
	50% {
		background-color: color-mix(in oklab, var(--ped-warn) 24%, transparent);
		box-shadow: 0 0 0 3px color-mix(in oklab, var(--ped-warn) 12%, transparent);
	}
	100% {
		background-color: transparent;
		box-shadow: 0 0 0 0 transparent;
	}
}

.no-config {
	opacity: 0;
	animation-name: fadeIn;
	animation-duration: 600ms;
	animation-timing-function: ease;
	animation-delay: 400ms;
	animation-fill-mode: forwards;
}

#SpeechSynthesisError {
	background-color: var(--card);
	background: var(--card);
	border-radius: 20px;
	// border: var(--border-width) * 1px ridge darkblue;
	color: var(--primary);
	// display: flex;
	font-size: var(--font-size-2xl);
	height: fit-content;
	inset: 0;
	line-height: calc(var(--font-size-2xl) * 1.5);
	margin: auto;
	min-height: 22vh;
	min-width: 80vw;
	padding: 1rem 0;
	position: fixed;
	text-align: center;
	width: fit-content;
	z-index: 1000;
	justify-content: center;
	align-items: center;
	// opacity: 1;
	// transition: opacity 0; //1s 2s;
	touch-action: none;
	opacity: 0;
	animation-name: fadeIn;
	animation-duration: 600ms;
	animation-timing-function: ease;
	animation-delay: 400ms;
	animation-fill-mode: forwards;
}

@keyframes fadeIn {
	0% {
		opacity: 0;
		display: none;
	}
	10% {
		display: flex;
	}
	100% {
		opacity: 1;
	}
}

.app {
	box-sizing: border-box;
	line-height: var(--line-height-app);
	margin: 0;
	overflow: hidden;
}

hr {
	border: none;
	height: 1px;
}

.container {
	position: relative;
	display: flex;
	flex-wrap: nowrap;
	justify-content: flex-start;
	// align-items: center;
	flex-direction: column;
	z-index: 1;
	// margin: 1rem auto;
	// max-width: 1200px;
	// touch-action: none;

	overflow: visible;
	padding: 0.5rem; // 3rem;
	box-sizing: border-box;
	.instructions {
		text-align: center;
	}
}

#hero {
	--hero-banner-title-color: var(--hero-title-color);
	position: relative;
	display: flex;
	flex-direction: column;
	justify-content: flex-start;
	align-items: flex-end;
	aspect-ratio: 16 / 9;
	min-height: clamp(340px, 56.25vw, 960px);
	margin-bottom: 0.5rem;
	margin-top: $header-height;
	max-width: 100%;
	overflow: hidden;
	padding: 1rem;

	.hero-image {
		position: absolute;
		inset: 0;
		width: 100%;
		height: 100%;
		display: block;
		object-fit: contain;
		object-position: center bottom;
	}

	.hero-title {
		position: relative;
		z-index: 1;
		margin: 0;
		// background: rgba(255, 255, 255, 0.6);
		color: var(--hero-banner-title-color);
		text-align: right;
		align-self: flex-end;
		width: 100%;
		font-size: clamp(var(--font-size-3xl), 7.25vw, calc(var(--font-size-3xl) * 1.4375));
		text-shadow:
			0 2px 6px color-mix(in oklab, var(--hero-banner-title-color) 50%, transparent),
			0 6px 14px color-mix(in oklab, var(--hero-banner-title-color) 35%, transparent);
		// box-shadow: 0 0 12px rgba(255, 255, 255, 0.5);
		padding: 1.4rem 3rem 0.35rem 0.6rem;
		border-radius: 8px;
	}
}

@media (max-width: 650px) {
	#hero {
		padding-top: 0.25rem;
		.hero-title {
			text-align: center;
			margin-top: 0;
			padding: 0.3rem 1.25rem 0.2rem;
			font-size: clamp(calc(var(--font-size-3xl) * 0.6), 7.5vw, calc(var(--font-size-3xl) * 0.775));
		}
	}
	#content {
		h1 {
			font-size: clamp(calc(var(--font-size-3xl) * 0.4), 5.2vw, calc(var(--font-size-3xl) * 0.525));
			padding: 0 0.75rem;
		}
		.title-main {
			font-size: calc(var(--font-size-sm) * 1.6);
		}
		.title-sub {
			font-size: calc(var(--font-size-sm) * 0.9);
			margin-top: 0.25rem;
		}
	}
}

#content {
	width: 100vw;
	max-width: 1400px;
	color: var(--foreground);
	text-align: left;
	padding: 1rem 0;
	margin: auto;
	margin-bottom: 4rem;
	// margin-top: $main-menu-height;
	ul {
		margin: 2rem 0;
		padding-left: 1.2rem;
		list-style: disc; // Apologies, this is necessary because tailwind (which I hate) removes the most basic of defaults so that you have to add bloat to bring it back to expected behaviour.
	}
	li {
		.video {
			margin-left: -40px;
		}
	}
	.instructions,
	.intro {
		ul {
			list-style: disc;
		}
	}
	.abbreviations {
		font-size: var(--font-size-base);
		line-height: var(--line-height-body);
		margin-top: 0.75rem;
	}
	:where(p, li, td, th, figcaption, caption) {
		font-size: var(--font-size-base);
		line-height: var(--line-height-body);
	}
	.inline-icon {
		display: inline-block;
		width: 1.25em;
		height: 1.25em;
		margin: 0 0.2em;
		vertical-align: -0.15em;
		background-color: currentColor;
		transform: translateY(0.05em);
		-webkit-mask-repeat: no-repeat;
		-webkit-mask-position: center;
		-webkit-mask-size: contain;
		mask-repeat: no-repeat;
		mask-position: center;
		mask-size: contain;
	}
	.inline-icon-eye {
		background-color: var(--ped-warn);
		-webkit-mask-image: url("/images/icons/eye.svg");
		mask-image: url("/images/icons/eye.svg");
	}
	.inline-icon-reset {
		background-color: var(--chart-2);
		-webkit-mask-image: url("/images/icons/reset.svg");
		mask-image: url("/images/icons/reset.svg");
	}
	.inline-icon-check {
		background-color: var(--chart-3);
		-webkit-mask-image: url("/images/icons/circle-check.svg");
		mask-image: url("/images/icons/circle-check.svg");
	}
	.word-parts-container table td,
	.word-parts-container table span {
		font-size: calc(var(--font-size-base) * 1.5);
		line-height: var(--line-height-wordparts);
	}
	h1,
	h2,
	h3,
	h4 {
		color: var(--foreground);
	}
	.intro {
		h2 {
			margin-bottom: 2rem;
			font-size: var(--font-size-lg);
		}
		p {
			font-size: var(--font-size-xl);
			line-height: var(--line-height-body-loose);
		}
	}
	.hero-section {
		.intro-split {
			.intro-split-image {
				margin-top: -1.1rem;
				max-width: none;
				width: 100%;
			}
			.information {
				margin-top: 0;
			}
			.info-content {
				transform: none;
			}
		}
	}
	.title-sub {
		display: block;
		margin-top: 0.4rem;
		color: var(--muted-foreground);
	}
	.section h2 {
		margin-top: 0;
		margin-bottom: 0;
	}
	.video {
		border-width: 5px;
		border-style: ridge;
		border-color: var(--border);
		border-radius: 4px;
		width: 560px;
		height: 315px;
		max-width: 90vw;
		max-height: 90vh;
	}
	.html-content {
		width: 100%;
		border-radius: 12px;
		box-sizing: border-box;
	}
	> .html-content {
		padding: $common-left-margin;
	}
	.html-content,
	.instructions {
		padding: 0 1vw;
	}
	.instructions {
		// Typography now comes from utility classes/tokens.
	}

	.footnote {
		font-size: var(--font-size-xs);
	}

	.audio-clip {
		margin: 1.4rem 0;
		audio {
			border: 1px solid var(--border);
			border-radius: 0.6rem;
			background: var(--muted); //#f9f9f9;
			max-height: 40px;
		}
	}

	// span.audio-link,
		a {
			color: var(--primary);
			cursor: pointer;
			text-decoration: underline;
			&.modal-link-target {
				color: initial;
				text-decoration: initial;
				display: block;
				pointer-events: none; // Doesn't work :-(
			}
		}
}

.fr-FR {
	#hero {
		// background-repeat: no-repeat;
		background-position: center center;
		// background-size: cover;
		display: flex;
		justify-content: flex-start;
		align-items: flex-start;
	}
	#content {
		#radio2 {
			span:nth-of-type(1) {
				min-width: 30px;
			}
			li {
				min-width: 0;
			}
		}
	}
}

@media (max-width: 959px) {
	#content {
	.word-parts-container table td,
	.word-parts-container table span {
		font-size: calc(var(--font-size-base) * 1.15);
		line-height: var(--line-height-wordparts-mobile);
	}
}
}

.lo-15 {
	.blanks-container.type-questions-answers .word.blank {
		width: 210px;
	}
}

.lo-6 {
	#dropdowns2,
	#dropdowns3 {
		table {
			&.annabelle,
			&.camille {
				td {
					text-align: initial;
				}
			}
			td {
				text-align: right;
			}
		}
	}
}

.lo-demo {
	#picturesAndWords1 {
		.word {
			max-width: 160px;
		}
	}
}

@include respond-above(s) {
	.container {
		padding: 2rem 3rem;
	}
	#hero {
		h1 {
			font-size: clamp(calc(var(--font-size-3xl) * 0.55), 4vw, calc(var(--font-size-3xl) * 0.75));
		}
	}
}

@include respond-below(l) {
	#content {
		#imagePlaceholder {
			margin: 1rem 0;
		}
	}
}

@include respond-above(m) {
	$header-height: 8rem;
	#hero {
		h1 {
			font-size: clamp(calc(var(--font-size-3xl) * 0.6), 4vw, calc(var(--font-size-3xl) * 0.875));
		}
	}
	#content {
		padding: 1rem 2rem;
	}

	.content {
		text-align: justify;
		margin: 0 auto;
		li {
			.video {
				margin-left: 40px;
			}
		}
		.video {
			margin-left: 40px;
		}
	}

	p {
		line-height: var(--line-height-body-tight);
	}
	.spinning-globe {
		width: 256px;
		height: 256px;
		position: relative;
		img {
			width: 100%;
			height: 100%;
		}
		&::after {
			// Crap attempt to anti-aliase
			content: "";
			width: 102%;
			height: 102%;
			position: absolute;
			border: 4px solid $background-colour; //white; // #e3e2fd;
			z-index: 12;
			border-radius: 50%;
			top: -1%;
			left: -1%;
			box-sizing: border-box;
			filter: blur(1px);
		}
	}
}

@include respond-above(xl) {
	#hero {
		h1 {
			font-size: calc(var(--font-size-3xl) * 0.75);
		}
	}
	#content {
		padding: 1rem 2rem;
		width: calc(100vw - 4rem);
	}
}

@media print {
	.noprint {
		display: none;
	}
}
#content .modal-link {
	color: var(--ped-warn);
	text-decoration-color: color-mix(in oklab, var(--ped-warn) 60%, transparent);
	font-weight: 600;
}
#content .modal-link:visited {
	color: var(--ped-warn);
	text-decoration-color: color-mix(in oklab, var(--ped-warn) 60%, transparent);
}
